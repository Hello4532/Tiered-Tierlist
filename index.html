<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rankings Template (McTiers-style layout)</title>

  <!--
    EDITING GUIDE (READ THIS FIRST)

    You only edit TWO places:
    1) PLACEMENTS  -> where players are placed into tiers per gamemode
    2) PLAYER_META -> optional: region / notes (for the left colored region bar + region pill)

    HOW TO ADD A PLAYER (easy):
      - Pick a mode (uhc, sword, etc)
      - Pick a tier array (HT1, LT2, RHT1, etc)
      - Add the name as a string

      Example:
        PLACEMENTS.uhc.HT1.push("Heartz");
        PLACEMENTS.sword.LT2.push("Heartz");
        PLAYER_META["Heartz"] = { region: "NA" };

      Or just directly inside the arrays below:
        PLACEMENTS = {
          uhc: {
            HT1: ["Heartz"],
            ...
          }
        }

    OVERALL PAGE:
      - You do NOT enter overall manually.
      - Overall is automatically calculated from all gamemode placements using points:
        HT1 60, LT1 45, HT2 30, LT2 20, HT3 10, LT3 6, HT4 4, LT4 3, HT5 2, LT5 1
        Retired tiers (RHT1/RLT1/RHT2/RLT2) give the same points as their base tier.

    RETIRED TIERS:
      - Only these exist: RHT1, RLT1, RHT2, RLT2
      - They render gray.

    IMPORTANT:
      - This is NOT affiliated with McTiers.
      - No real ranking data is included by default.
  -->

  <style>
    :root{
      --bg0:#070a12;
      --bg1:#0a0f1b;
      --panel:#0e1526;
      --panel2:#0b1220;
      --stroke:rgba(255,255,255,.08);
      --stroke2:rgba(255,255,255,.12);
      --text:#e9eefc;
      --muted:#9aa7c4;
      --muted2:#7f8aa5;
      --glow:rgba(138,105,255,.35);
      --glow2:rgba(64,201,255,.20);

      --gold1:#f2c14e; --gold2:#8a6a2a;
      --silv1:#bfc7d8; --silv2:#5f6a82;
      --bron1:#c47b46; --bron2:#5b2f1c;

      --na:#8a2b3e;
      --eu:#1e7f49;
      --as:#7a6a33;

      --ht:#4cff9c;
      --lt:#ffd36a;
      --ret:#8f97aa;

      --chipBg:rgba(255,255,255,.06);
      --chipStroke:rgba(255,255,255,.12);

      --radius:18px;
      --radius2:14px;

      --shadow: 0 18px 60px rgba(0,0,0,.55);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 35% -10%, rgba(138,105,255,.20), transparent 55%),
        radial-gradient(900px 600px at 70% 0%, rgba(64,201,255,.14), transparent 55%),
        radial-gradient(900px 600px at 40% 70%, rgba(0,255,170,.06), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:18px 18px 40px;
    }

    /* Sticky header */
    .topbar{
      position:sticky;
      top:0;
      z-index:50;
      padding-top:12px;
      background: linear-gradient(180deg, rgba(7,10,18,.92), rgba(7,10,18,.55) 60%, transparent);
      backdrop-filter: blur(10px);
    }

    .topbarInner{
      display:flex;
      align-items:center;
      gap:14px;
      padding:14px 14px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius:22px;
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:210px;
    }
    .logoMark{
      width:34px;height:34px;
      border-radius:10px;
      background:
        radial-gradient(10px 10px at 30% 30%, rgba(255,255,255,.16), transparent 60%),
        linear-gradient(135deg, rgba(138,105,255,.55), rgba(64,201,255,.25));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 0 6px rgba(138,105,255,.08);
      display:grid;
      place-items:center;
    }
    .logoMark svg{opacity:.95}
    .brandText{
      line-height:1.05;
    }
    .brandText b{
      display:block;
      letter-spacing:.09em;
      font-size:14px;
    }
    .brandText span{
      display:block;
      font-size:12px;
      color:var(--muted);
    }

    .navLinks{
      display:flex;
      align-items:center;
      gap:18px;
      color:var(--muted);
      font-weight:600;
      font-size:13px;
      opacity:.9;
    }
    .navLinks a{
      color:inherit;
      text-decoration:none;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid transparent;
    }
    .navLinks a:hover{
      color:var(--text);
      border-color:rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
    }

    .spacer{flex:1}

    .search{
      min-width:280px;
      max-width:520px;
      width:44vw;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.20);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .search svg{opacity:.7}
    .search input{
      flex:1;
      border:0;
      outline:0;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .search input::placeholder{color:rgba(170,185,220,.65)}
    .kbd{
      font-size:12px;
      color:rgba(170,185,220,.7);
      padding:3px 8px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
    }

    .actions{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      font-weight:700;
      font-size:13px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{
      background: rgba(255,255,255,.07);
      border-color: rgba(255,255,255,.18);
      transform: translateY(-1px);
    }
    .btn:active{transform: translateY(0px)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(138,105,255,.28), rgba(64,201,255,.12));
      border-color: rgba(138,105,255,.35);
      box-shadow: 0 0 0 6px rgba(138,105,255,.08);
    }

    /* Mode tabs */
    .modeTabs{
      margin-top:14px;
      padding:10px;
      border:1px solid var(--stroke);
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: 0 14px 55px rgba(0,0,0,.38);
      overflow:auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.14) transparent;
    }
    .modeTabs::-webkit-scrollbar{height:10px}
    .modeTabs::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14); border-radius:999px}
    .modeTabsRow{
      display:flex;
      gap:10px;
      min-width:max-content;
      align-items:center;
    }

    .tab{
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:6px;
      width:84px;
      padding:10px 8px;
      border-radius:18px;
      border:1px solid transparent;
      background: rgba(0,0,0,.16);
      color:rgba(205,215,245,.85);
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
    }
    .tab:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .tab.active{
      border-color: rgba(138,105,255,.45);
      box-shadow: 0 0 0 6px rgba(138,105,255,.08), inset 0 0 0 1px rgba(255,255,255,.03);
      background: rgba(0,0,0,.24);
    }
    .tabIcon{
      width:28px;height:28px;
      display:grid;place-items:center;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }
    .tabIcon svg{opacity:.92}
    .tabLabel{
      font-weight:800;
      font-size:12px;
      letter-spacing:.02em;
      opacity:.92;
    }
    .tabUnderline{
      width:34px;
      height:3px;
      border-radius:999px;
      background: rgba(255,255,255,.0);
    }
    .tab.active .tabUnderline{
      background: linear-gradient(90deg, rgba(138,105,255,.8), rgba(64,201,255,.55));
      box-shadow: 0 0 18px rgba(138,105,255,.25);
    }

    /* Content header */
    .sectionHead{
      margin-top:14px;
      padding:14px 14px;
      border-radius:22px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      display:flex;
      align-items:flex-start;
      gap:12px;
      justify-content:space-between;
    }
    .sectionTitle{
      font-size:18px;
      font-weight:900;
      letter-spacing:.02em;
    }
    .sectionSub{
      margin-top:2px;
      color:var(--muted);
      font-size:13px;
      font-weight:650;
      max-width:820px;
    }
    .pillRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }
    .pill{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color:rgba(210,220,245,.92);
      font-size:12px;
      font-weight:800;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .pill b{color:var(--text)}
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: rgba(138,105,255,.65);
      box-shadow: 0 0 0 4px rgba(138,105,255,.12);
    }

    /* Table (overall) */
    .table{
      margin-top:12px;
      border-radius:24px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      overflow:hidden;
      box-shadow: 0 18px 70px rgba(0,0,0,.42);
    }
    .thead{
      display:grid;
      grid-template-columns: 1fr 120px 520px;
      gap:12px;
      padding:14px 14px;
      color:rgba(180,195,230,.65);
      font-size:12px;
      font-weight:900;
      letter-spacing:.16em;
      text-transform:uppercase;
      border-bottom:1px solid rgba(255,255,255,.06);
      background: rgba(0,0,0,.22);
    }
    .thead div:last-child{text-align:right}

    .oRow{
      position:relative;
      display:grid;
      grid-template-columns: 1fr 120px 520px;
      gap:12px;
      padding:10px 14px;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,.05);
      cursor:pointer;
      transition: transform .12s ease, background .12s ease;
    }
    .oRow:hover{
      background: rgba(255,255,255,.02);
      transform: translateY(-1px);
    }
    .oRow:active{transform: translateY(0px)}
    .oLeft{
      position:relative;
      display:flex;
      align-items:center;
      gap:14px;
      min-height:64px;
      padding-left:6px;
    }
    .banner{
      position:absolute;
      inset:0 auto 0 0;
      width:min(520px, 92%);
      border-radius:18px;
      clip-path: polygon(0% 0%, 86% 0%, 100% 50%, 86% 100%, 0% 100%, 4% 50%);
      opacity:.95;
      filter: saturate(1.1);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }
    .banner.rank1{background: linear-gradient(90deg, rgba(242,193,78,.92), rgba(138,106,42,.45) 70%, rgba(10,15,27,0));}
    .banner.rank2{background: linear-gradient(90deg, rgba(191,199,216,.92), rgba(95,106,130,.50) 70%, rgba(10,15,27,0));}
    .banner.rank3{background: linear-gradient(90deg, rgba(196,123,70,.92), rgba(91,47,28,.55) 70%, rgba(10,15,27,0));}
    .banner.rankN{background: linear-gradient(90deg, rgba(70,88,140,.65), rgba(25,35,60,.45) 70%, rgba(10,15,27,0));}

    .rankNum{
      position:relative;
      z-index:2;
      width:56px;
      text-align:center;
      font-size:22px;
      font-weight:950;
      letter-spacing:.01em;
      color:rgba(255,255,255,.95);
      text-shadow: 0 10px 22px rgba(0,0,0,.45);
    }
    .avatar{
      position:relative;
      z-index:2;
      width:36px;height:36px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .avatar img{width:100%;height:100%;display:block;image-rendering: pixelated;}
    .identity{
      position:relative;
      z-index:2;
      display:flex;
      flex-direction:column;
      gap:2px;
      padding-left:2px;
    }
    .name{
      font-size:20px;
      font-weight:950;
      letter-spacing:.01em;
    }
    .subtitle{
      display:flex;
      gap:8px;
      align-items:center;
      color:rgba(195,208,240,.85);
      font-size:13px;
      font-weight:800;
    }
    .medal{
      width:10px;height:10px;border-radius:3px;
      background: linear-gradient(135deg, rgba(242,193,78,.85), rgba(242,193,78,.25));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 0 5px rgba(242,193,78,.08);
    }
    .subtitle span{color:rgba(195,208,240,.7); font-weight:700}

    .regionPill{
      justify-self:center;
      padding:8px 12px;
      min-width:56px;
      text-align:center;
      font-weight:950;
      font-size:13px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }
    .rNA{background: linear-gradient(180deg, rgba(138,43,62,.42), rgba(138,43,62,.22));}
    .rEU{background: linear-gradient(180deg, rgba(30,127,73,.42), rgba(30,127,73,.22));}
    .rAS{background: linear-gradient(180deg, rgba(122,106,51,.42), rgba(122,106,51,.22));}

    .tiersCell{
      justify-self:end;
      width:100%;
      display:flex;
      justify-content:flex-end;
    }

    /* IMPORTANT FIX FOR "MENU NOT LINING UP WITH TIERS":
       This matrix uses a fixed-column grid + no wrapping, so icons/tier chips always line up. */
    .tiersMatrix{
      --colw: 56px;
      display:grid;
      grid-auto-flow:column;
      grid-auto-columns: var(--colw);
      gap:10px;
      align-items:start;
      justify-content:end;
      max-width:100%;
      overflow-x:auto;
      padding-bottom:2px;
      scrollbar-gutter: stable;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.14) transparent;
    }
    .tiersMatrix::-webkit-scrollbar{height:10px}
    .tiersMatrix::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14); border-radius:999px}

    .modeBadge{
      width:var(--colw);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
    }
    .modeCircle{
      width:34px;height:34px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:
        radial-gradient(10px 10px at 30% 30%, rgba(255,255,255,.14), transparent 60%),
        rgba(255,255,255,.04);
      display:grid;
      place-items:center;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    .modeCircle svg{opacity:.9}
    .tierChip{
      font-size:11px;
      font-weight:950;
      letter-spacing:.04em;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--chipStroke);
      background: var(--chipBg);
      color:rgba(240,245,255,.92);
      line-height:1;
    }
    .tierChip.ht{ border-color: rgba(76,255,156,.22); background: rgba(76,255,156,.08); }
    .tierChip.lt{ border-color: rgba(255,211,106,.22); background: rgba(255,211,106,.08); }
    .tierChip.ret{ border-color: rgba(143,151,170,.22); background: rgba(143,151,170,.10); color: rgba(220,228,245,.82); }

    /* Mode view (Tier columns) */
    .grid5{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(5, minmax(180px, 1fr));
      gap:14px;
      align-items:start;
    }
    .tierCol{
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border-radius:22px;
      padding:12px;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      min-height:220px;
    }
    .tierHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:8px 8px 10px;
      border-radius:16px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.08);
      margin-bottom:10px;
    }
    .tierHead .left{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:950;
      letter-spacing:.02em;
      font-size:16px;
    }
    .tierHead .left .cup{
      width:26px;height:26px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      display:grid;
      place-items:center;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }

    .tierTint1{background: linear-gradient(180deg, rgba(242,193,78,.18), rgba(0,0,0,.0) 72%), rgba(0,0,0,.20);}
    .tierTint2{background: linear-gradient(180deg, rgba(191,199,216,.14), rgba(0,0,0,.0) 72%), rgba(0,0,0,.20);}
    .tierTint3{background: linear-gradient(180deg, rgba(196,123,70,.14), rgba(0,0,0,.0) 72%), rgba(0,0,0,.20);}

    .sortToggle{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:900;
      font-size:12px;
      color:rgba(215,225,250,.85);
      user-select:none;
    }
    .sortToggle input{
      width:14px;height:14px;
      accent-color: rgb(138,105,255);
    }

    .pList{
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .pCard{
      position:relative;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.18);
      box-shadow: 0 14px 40px rgba(0,0,0,.30);
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      overflow:hidden;
    }
    .pCard:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.14);
      background: rgba(255,255,255,.02);
    }
    .pCard:active{transform: translateY(0px)}
    .pCard::before{
      content:"";
      position:absolute;
      left:0; top:0; bottom:0;
      width:4px;
      background: rgba(255,255,255,.10);
      opacity:.95;
    }
    .pCard[data-region="NA"]::before{background: linear-gradient(180deg, rgba(255,70,105,.95), rgba(138,43,62,.55));}
    .pCard[data-region="EU"]::before{background: linear-gradient(180deg, rgba(60,255,160,.95), rgba(30,127,73,.55));}
    .pCard[data-region="AS"]::before{background: linear-gradient(180deg, rgba(255,216,90,.95), rgba(122,106,51,.55));}

    .pCard .pAva{
      width:28px;height:28px;border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      flex:0 0 auto;
      margin-left:6px;
    }
    .pCard .pAva img{width:100%;height:100%;display:block;image-rendering: pixelated;}
    .pCard .pName{
      font-weight:950;
      letter-spacing:.01em;
      font-size:14px;
    }
    .pRight{
      margin-left:auto;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .arrowBtn{
      width:26px;height:26px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:rgba(220,232,255,.65);
      display:grid;
      place-items:center;
      font-weight:950;
      font-size:12px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .arrowBtn.onHT{
      border-color: rgba(76,255,156,.20);
      background: rgba(76,255,156,.10);
      color: rgba(220,255,238,.95);
      box-shadow: 0 0 0 5px rgba(76,255,156,.07);
    }
    .arrowBtn.onLT{
      border-color: rgba(255,211,106,.20);
      background: rgba(255,211,106,.10);
      color: rgba(255,246,225,.95);
      box-shadow: 0 0 0 5px rgba(255,211,106,.07);
    }
    .arrowBtn.onRET{
      border-color: rgba(143,151,170,.25);
      background: rgba(143,151,170,.14);
      color: rgba(230,235,248,.80);
      box-shadow: 0 0 0 5px rgba(143,151,170,.07);
    }

    .empty{
      padding:16px 10px;
      color:rgba(170,185,220,.65);
      font-weight:800;
      font-size:13px;
    }

    /* Modal */
    .modalOverlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.62);
      backdrop-filter: blur(10px);
      z-index:100;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .modalOverlay.show{display:flex}

    .modal{
      width:min(980px, 96vw);
      max-height:min(82vh, 780px);
      border-radius:24px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(900px 380px at 30% 0%, rgba(138,105,255,.20), transparent 55%),
        radial-gradient(800px 380px at 70% 10%, rgba(64,201,255,.14), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow:hidden;
      display:grid;
      grid-template-columns: 320px 1fr;
      scrollbar-gutter: stable;
    }

    .modalLeft{
      padding:16px;
      border-right:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.18);
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:320px;
    }
    .modalSkin{
      width:100%;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      overflow:hidden;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      display:grid;
      place-items:center;
      padding:10px;
    }
    .modalSkin img{
      width:100%;
      height:auto;
      max-height:420px;
      object-fit:contain;
      image-rendering: pixelated;
      display:block;
    }
    .modalMini{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .modalMini .avatar{
      width:34px;height:34px;border-radius:12px;
    }
    .modalMini .meta{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .modalMini .meta b{font-size:14px; letter-spacing:.01em}
    .modalMini .meta span{color:rgba(190,205,238,.75); font-weight:800; font-size:12px}

    .modalRight{
      padding:16px;
      overflow:auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.14) transparent;
    }
    .modalRight::-webkit-scrollbar{width:10px}
    .modalRight::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14); border-radius:999px}

    .modalTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .modalTop .title{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .modalTop .title b{
      font-size:22px;
      font-weight:950;
      letter-spacing:.01em;
    }
    .modalTop .title span{
      color:rgba(195,210,244,.80);
      font-weight:850;
      font-size:13px;
    }
    .closeBtn{
      width:38px;height:38px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(235,242,255,.90);
      cursor:pointer;
      font-weight:950;
      display:grid;
      place-items:center;
      transition: transform .12s ease, background .12s ease;
      user-select:none;
    }
    .closeBtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.03)}
    .closeBtn:active{transform: translateY(0px)}

    .modalBlocks{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }

    .card{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      box-shadow: 0 18px 60px rgba(0,0,0,.26);
      padding:12px;
    }
    .card h3{
      margin:0 0 10px 0;
      font-size:12px;
      letter-spacing:.16em;
      text-transform:uppercase;
      color:rgba(180,195,230,.70);
    }

    .placementsList{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .placeChip{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      font-weight:900;
      font-size:12px;
      color:rgba(230,238,255,.92);
    }
    .placeChip small{
      color:rgba(185,200,235,.78);
      font-weight:900;
      letter-spacing:.06em;
    }

    /* Modal tier matrix: fixed columns, never wraps */
    .modalMatrixWrap{
      overflow-x:auto;
      padding-bottom:2px;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.14) transparent;
      scrollbar-gutter: stable;
    }
    .modalMatrixWrap::-webkit-scrollbar{height:10px}
    .modalMatrixWrap::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14); border-radius:999px}

    .modalMatrix{
      --colw: 64px;
      display:grid;
      grid-auto-flow:column;
      grid-auto-columns: var(--colw);
      gap:12px;
      align-items:start;
      width:max-content;
      padding:6px 2px;
    }

    /* Small helpers */
    .hl{ color:#fff; background: rgba(255,255,255,.10); padding:1px 4px; border-radius:6px; }
    .muted{color:var(--muted)}

    @media (max-width: 980px){
      .thead, .oRow{grid-template-columns: 1fr 96px 420px;}
      .tiersMatrix{--colw:52px}
    }
    @media (max-width: 860px){
      .navLinks{display:none}
      .search{min-width:220px}
      .thead, .oRow{grid-template-columns: 1fr 88px 1fr;}
      .tiersCell{justify-self:stretch}
      .modal{grid-template-columns: 1fr; max-height: 86vh;}
      .modalLeft{border-right:0; border-bottom:1px solid rgba(255,255,255,.08)}
      .grid5{grid-template-columns: 1fr; }
    }

    @media (prefers-reduced-motion: reduce){
      *{transition:none !important}
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="wrap">
      <div class="topbarInner">
        <div class="brand">
          <div class="logoMark" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M12 2l8 4.5v11L12 22l-8-4.5v-11L12 2z" stroke="rgba(240,245,255,.9)" stroke-width="1.5"/>
              <path d="M12 6l5 2.8v6.4L12 18l-5-2.8V8.8L12 6z" stroke="rgba(240,245,255,.75)" stroke-width="1.5"/>
            </svg>
          </div>
          <div class="brandText">
            <b>RANKINGS</b>
          </div>
        </div>

        <div class="navLinks" aria-hidden="true">
          <a href="javascript:void(0)">Home</a>
          <a href="javascript:void(0)">Rankings</a>
          <a href="javascript:void(0)">Discords</a>
          <a href="javascript:void(0)">API Docs</a>
        </div>

        <div class="spacer"></div>

        <div class="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="rgba(240,245,255,.75)" stroke-width="1.6"/>
            <path d="M16.5 16.5L21 21" stroke="rgba(240,245,255,.65)" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
          <input id="searchInput" placeholder="Search player..." autocomplete="off" />
          <span class="kbd">/</span>
        </div>

        <div class="actions">
        </div>
      </div>

      <div class="modeTabs">
        <div class="modeTabsRow" id="tabs"></div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="sectionHead">
      <div>
        <div class="sectionTitle" id="sectionTitle">Overall</div>
        <div class="sectionSub" id="sectionSub">
          Overall is sorted by total points across all modes. Click a player for profile.
        </div>
      </div>
      <div class="pillRow">
        <div class="pill"><span class="dot"></span><span><b id="visibleCount">0</b> visible</span></div>
        <div class="pill"><span class="dot" style="background:rgba(64,201,255,.65); box-shadow:0 0 0 4px rgba(64,201,255,.12)"></span><span><b id="playerCount">0</b> players</span></div>
        <div class="pill"><span class="dot" style="background:rgba(76,255,156,.65); box-shadow:0 0 0 4px rgba(76,255,156,.12)"></span><span>on <b id="phState">placeholders</b></span></div>
      </div>
    </div>

    <div id="content"></div>
  </div>

  <!-- Profile Modal -->
  <div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <div class="modalLeft">
        <div class="modalSkin">
          <img id="modalBodyImg" alt="Skin render" />
        </div>
        <div class="modalMini">
          <div class="avatar"><img id="modalHeadImg" alt="Avatar head" /></div>
          <div class="meta">
            <b id="modalName">Player</b>
            <span id="modalMiniLine">Region • Title</span>
          </div>
        </div>
      </div>
      <div class="modalRight">
        <div class="modalTop">
          <div class="title">
            <b id="modalNameBig">Player</b>
            <span id="modalSubtitle">Combat Rank (0 points)</span>
          </div>
          <button class="closeBtn" id="modalCloseBtn" aria-label="Close">×</button>
        </div>

        <div class="modalBlocks">
          <div class="card">
            <h3>Placements</h3>
            <div class="placementsList" id="modalPlacements"></div>
          </div>

          <div class="card">
            <h3>Tiers</h3>
            <div class="modalMatrixWrap">
              <div class="modalMatrix" id="modalMatrix"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden file input for import (kept truly off-screen to avoid white-bar/glitch) -->
  <input id="fileInput" type="file" accept="application/json"
         style="position:fixed; left:-9999px; top:-9999px; width:1px; height:1px; opacity:0; pointer-events:none;" />

  <script>
    /******************************************************************
     * CONFIG
     ******************************************************************/
    const USE_PLACEHOLDERS = false; // set false for "no players by default" mode

    // Skin endpoints (external image services).
    // You asked for "NameMC", but NameMC doesn't provide a stable direct image CDN for heads/bodies.
    // These are common MC render endpoints. If you have a NameMC image URL pattern you prefer,
    // replace AVATAR_URL and BODY_URL.
    const AVATAR_URL = (name, size=64) => `https://minotar.net/avatar/${encodeURIComponent(name)}/${size}.png`;
    const BODY_URL   = (name, size=300) => `https://minotar.net/armor/body/${encodeURIComponent(name)}/${size}.png`;

    const MODE_DEFS = [
      { key:"overall", label:"Overall", icon: svgTrophy() },
      { key:"ltms",    label:"LTMs",    icon: svgX() },
      { key:"vanilla", label:"Vanilla", icon: svgCube() },
      { key:"uhc",     label:"UHC",     icon: svgHeart() },
      { key:"pot",     label:"Pot",     icon: svgPotion() },
      { key:"nethop",  label:"NethOP",  icon: svgSkull() },
      { key:"smp",     label:"SMP",     icon: svgOrb() },
      { key:"sword",   label:"Sword",   icon: svgSword() },
      { key:"axe",     label:"Axe",     icon: svgAxe() },
      { key:"mace",    label:"Mace",    icon: svgMace() },
    ];

    const MODE_KEYS = MODE_DEFS.map(m => m.key);
    const MODE_KEYS_NO_OVERALL = MODE_KEYS.filter(k => k !== "overall");

    const TIER_KEYS = ["HT1","LT1","HT2","LT2","HT3","LT3","HT4","LT4","HT5","LT5","RHT1","RLT1","RHT2","RLT2"];

    // Points for overall
    const TIER_POINTS = {
      HT1:60, LT1:45,
      HT2:30, LT2:20,
      HT3:10, LT3:6,
      HT4:4,  LT4:3,
      HT5:2,  LT5:1,
      RHT1:60, RLT1:45,
      RHT2:30, RLT2:20,
    };

    // Which tier-column a tier belongs to (Tier 1..5)
    const TIER_GROUP = {
      HT1:1, LT1:1, RHT1:1, RLT1:1,
      HT2:2, LT2:2, RHT2:2, RLT2:2,
      HT3:3, LT3:3,
      HT4:4, LT4:4,
      HT5:5, LT5:5,
    };

    // Optional: player regions (for left bar + region pill)
    // region: "NA" | "EU" | "AS"
    const PLAYER_META = {
      // "Player A": { region:"NA" },
    };

    /******************************************************************
     * EDIT THIS: PLACEMENTS (all modes + all tiers already included)
     * Put player names inside arrays. Overall is auto-calculated.
     ******************************************************************/
    let PLACEMENTS = makeBlankPlacements();
    /*delete the slashes whenever you first add someone*/
PLACEMENTS.uhc.HT1 = [""];
PLACEMENTS.uhc.LT1 = [""];
PLACEMENTS.uhc.HT2 = [""];
PLACEMENTS.uhc.LT2 = [""];
PLACEMENTS.uhc.RHT1 = [""];
PLACEMENTS.uhc.RLT1 = [""];
PLACEMENTS.uhc.RHT2 = [""];
PLACEMENTS.uhc.RLT2 = [""];
PLACEMENTS.uhc.HT3 = [""];
PLACEMENTS.uhc.LT3 = [""];
PLACEMENTS.uhc.HT4 = [""];
PLACEMENTS.uhc.LT4 = [""];
PLACEMENTS.uhc.HT5 = [""];
PLACEMENTS.uhc.LT5 = [""];
PLACEMENTS.smp.HT1 = [""];
PLACEMENTS.smp.LT1 = [""];
PLACEMENTS.smp.HT2 = [""];
PLACEMENTS.smp.LT2 = [""];
PLACEMENTS.smp.RHT1 = [""];
PLACEMENTS.smp.RLT1 = [""];
PLACEMENTS.smp.RHT2 = [""];
PLACEMENTS.smp.RLT2 = [""];
PLACEMENTS.smp.HT3 = [""];
PLACEMENTS.smp.LT3 = [""];
PLACEMENTS.smp.HT4 = [""];
PLACEMENTS.smp.LT4 = [""];
PLACEMENTS.smp.HT5 = [""];
PLACEMENTS.smp.LT5 = [""];
PLACEMENTS.vanilla.HT1 = [""];
PLACEMENTS.vanilla.LT1 = [""];
PLACEMENTS.vanilla.HT2 = [""];
PLACEMENTS.vanilla.LT2 = [""];
PLACEMENTS.vanilla.RHT1 = [""];
PLACEMENTS.vanilla.RLT1 = [""];
PLACEMENTS.vanilla.RHT2 = [""];
PLACEMENTS.vanilla.RLT2 = [""];
PLACEMENTS.vanilla.HT3 = ["MrFiree"];
PLACEMENTS.vanilla.LT3 = [""];
PLACEMENTS.vanilla.HT4 = [""];
PLACEMENTS.vanilla.LT4 = ["__Heartz"];
PLACEMENTS.vanilla.HT5 = [""];
PLACEMENTS.vanilla.LT5 = [""];
PLACEMENTS.pot.HT1 = [""];
PLACEMENTS.pot.LT1 = [""];
PLACEMENTS.pot.HT2 = [""];
PLACEMENTS.pot.LT2 = [""];
PLACEMENTS.pot.RHT1 = [""];
PLACEMENTS.pot.RLT1 = [""];
PLACEMENTS.pot.RHT2 = [""];
PLACEMENTS.pot.RLT2 = [""];
PLACEMENTS.pot.HT3 = [""];
PLACEMENTS.pot.LT3 = [""];
PLACEMENTS.pot.HT4 = [""];
PLACEMENTS.pot.LT4 = [""];
PLACEMENTS.pot.HT5 = [""];
PLACEMENTS.pot.LT5 = [""];
PLACEMENTS.nethop.HT1 = [""];
PLACEMENTS.nethop.LT1 = [""];
PLACEMENTS.nethop.HT2 = [""];
PLACEMENTS.nethop.LT2 = [""];
PLACEMENTS.nethop.RHT1 = [""];
PLACEMENTS.nethop.RLT1 = [""];
PLACEMENTS.nethop.RHT2 = [""];
PLACEMENTS.nethop.RLT2 = [""];
PLACEMENTS.nethop.HT3 = [""];
PLACEMENTS.nethop.LT3 = [""];
PLACEMENTS.nethop.HT4 = [""];
PLACEMENTS.nethop.LT4 = [""];
PLACEMENTS.nethop.HT5 = [""];
PLACEMENTS.nethop.LT5 = [""];
PLACEMENTS.sword.HT1 = [""];
PLACEMENTS.sword.LT1 = [""];
PLACEMENTS.sword.HT2 = [""];
PLACEMENTS.sword.LT2 = [""];
PLACEMENTS.sword.RHT1 = [""];
PLACEMENTS.sword.RLT1 = [""];
PLACEMENTS.sword.RHT2 = [""];
PLACEMENTS.sword.RLT2 = [""];
PLACEMENTS.sword.HT3 = ["MrFiree"];
PLACEMENTS.sword.LT3 = [""];
PLACEMENTS.sword.HT4 = [""];
PLACEMENTS.sword.LT4 = ["__Heartz"];
PLACEMENTS.sword.HT5 = [""];
PLACEMENTS.sword.LT5 = [""];
PLACEMENTS.axe.HT1 = [""];
PLACEMENTS.axe.LT1 = [""];
PLACEMENTS.axe.HT2 = [""];
PLACEMENTS.axe.LT2 = [""];
PLACEMENTS.axe.RHT1 = [""];
PLACEMENTS.axe.RLT1 = [""];
PLACEMENTS.axe.RHT2 = [""];
PLACEMENTS.axe.RLT2 = [""];
PLACEMENTS.axe.HT3 = ["MrFiree"];
PLACEMENTS.axe.LT3 = [""];
PLACEMENTS.axe.HT4 = [""];
PLACEMENTS.axe.LT4 = ["__Heartz"];
PLACEMENTS.axe.HT5 = [""];
PLACEMENTS.axe.LT5 = [""];
PLAYER_META["", ""] = { region:"NA" };

    if (USE_PLACEHOLDERS) {
      // auto-fill placeholders so it looks populated
      autoFillPlaceholders();
    }

    /******************************************************************
     * UI STATE
     ******************************************************************/
    const state = {
      mode: "overall",
      q: "",
      sortAZ: { 1:false, 2:false, 3:false, 4:false, 5:false },
      openPlayer: null
    };

    /******************************************************************
     * INIT
     ******************************************************************/
    const elTabs = document.getElementById("tabs");
    const elContent = document.getElementById("content");
    const elSearch = document.getElementById("searchInput");
    const elTitle = document.getElementById("sectionTitle");
    const elSub = document.getElementById("sectionSub");
    const elVisible = document.getElementById("visibleCount");
    const elPlayers = document.getElementById("playerCount");
    const elPH = document.getElementById("phState");

    const modalOverlay = document.getElementById("modalOverlay");
    const modalCloseBtn = document.getElementById("modalCloseBtn");
    const modalBodyImg = document.getElementById("modalBodyImg");
    const modalHeadImg = document.getElementById("modalHeadImg");
    const modalName = document.getElementById("modalName");
    const modalNameBig = document.getElementById("modalNameBig");
    const modalMiniLine = document.getElementById("modalMiniLine");
    const modalSubtitle = document.getElementById("modalSubtitle");
    const modalPlacements = document.getElementById("modalPlacements");
    const modalMatrix = document.getElementById("modalMatrix");

    const exportBtn = document.getElementById("exportBtn");
    const importBtn = document.getElementById("importBtn");
    const fileInput = document.getElementById("fileInput");

    // Tabs
    renderTabs();

    // Search
    elSearch.addEventListener("input", () => {
      state.q = elSearch.value.trim();
      render();
    });

    // "/" focus
    window.addEventListener("keydown", (e) => {
      if (e.key === "/" && document.activeElement !== elSearch) {
        e.preventDefault();
        elSearch.focus();
      }
      if (e.key === "Escape") closeModal();
    });

    // Export/Import
    exportBtn.addEventListener("click", exportJSON);
    importBtn.addEventListener("click", () => fileInput.click());
    fileInput.addEventListener("change", async () => {
      const f = fileInput.files && fileInput.files[0];
      fileInput.value = "";
      if (!f) return;
      const text = await f.text();
      try{
        const parsed = JSON.parse(text);
        importJSON(parsed);
      }catch(err){
        alert("Invalid JSON file.");
      }
    });

    // Modal close
    modalCloseBtn.addEventListener("click", closeModal);
    modalOverlay.addEventListener("click", (e) => {
      if (e.target === modalOverlay) closeModal();
    });

    // Initial render
    elPH.textContent = USE_PLACEHOLDERS ? "placeholders" : "empty tiers";
    render();

    /******************************************************************
     * RENDER
     ******************************************************************/
    function render(){
      const dataset = buildDataset(); // computed player placements + points
      elPlayers.textContent = dataset.players.length;

      const modeDef = MODE_DEFS.find(m => m.key === state.mode);
      elTitle.textContent = modeDef ? modeDef.label : state.mode;

      if (state.mode === "overall") {
        elSub.textContent = "Overall is sorted by total points across all modes. Click a player for profile.";
        elContent.innerHTML = "";
        elContent.appendChild(renderOverall(dataset));
      } else {
        elSub.textContent = "Tier columns contain HT/LT together. ^ lights for HT, v lights for LT. Retired tiers are gray. Click a player for profile.";
        elContent.innerHTML = "";
        elContent.appendChild(renderMode(dataset, state.mode));
      }

      // counts
      elVisible.textContent = document.querySelectorAll("[data-visible='1']").length;
    }

    function renderTabs(){
      elTabs.innerHTML = "";
      for (const m of MODE_DEFS){
        const b = document.createElement("div");
        b.className = "tab" + (state.mode === m.key ? " active" : "");
        b.innerHTML = `
          <div class="tabIcon">${m.icon}</div>
          <div class="tabLabel">${m.label}</div>
          <div class="tabUnderline"></div>
        `;
        b.addEventListener("click", () => {
          state.mode = m.key;
          // update tabs active
          [...elTabs.children].forEach(x => x.classList.remove("active"));
          b.classList.add("active");
          render();
        });
        elTabs.appendChild(b);
      }
    }

    function renderOverall(dataset){
      const table = document.createElement("div");
      table.className = "table";

      const thead = document.createElement("div");
      thead.className = "thead";
      thead.innerHTML = `<div># &nbsp;&nbsp;&nbsp;&nbsp;PLAYER</div><div style="text-align:center">REGION</div><div style="text-align:right">TIERS</div>`;
      table.appendChild(thead);

      // filter
      const q = state.q.toLowerCase();
      const rows = dataset.overallSorted.filter(p => !q || p.name.toLowerCase().includes(q));

      rows.forEach((p, idx) => {
        const row = document.createElement("div");
        row.className = "oRow";
        row.dataset.visible = "1";
        row.addEventListener("click", () => openModal(p.name, dataset));

        const rankClass = idx === 0 ? "rank1" : idx === 1 ? "rank2" : idx === 2 ? "rank3" : "rankN";
        const region = (dataset.meta[p.name]?.region || PLAYER_META[p.name]?.region || "NA").toUpperCase();
        const regionClass = region === "EU" ? "rEU" : region === "AS" ? "rAS" : "rNA";

        const title = combatTitle(p.points);
        const nameHTML = highlight(p.name, q);

        row.innerHTML = `
          <div class="oLeft">
            <div class="banner ${rankClass}"></div>
            <div class="rankNum">${idx+1}.</div>
            <div class="avatar"><img alt="" src="${AVATAR_URL(p.name, 64)}" onerror="this.onerror=null;this.src='${fallbackAvatar()}';"></div>
            <div class="identity">
              <div class="name">${nameHTML}</div>
              <div class="subtitle"><span class="medal"></span> ${title} <span>(${p.points} points)</span></div>
            </div>
          </div>
          <div class="regionPill ${regionClass}">${region}</div>
          <div class="tiersCell"></div>
        `;

        // tiers matrix
        const tiersCell = row.querySelector(".tiersCell");
        const matrix = document.createElement("div");
        matrix.className = "tiersMatrix";
        for (const mk of MODE_KEYS_NO_OVERALL){
          const tier = dataset.bestTierByMode[mk]?.[p.name] || null;
          const badge = document.createElement("div");
          badge.className = "modeBadge";
          badge.innerHTML = `
            <div class="modeCircle">${MODE_DEFS.find(x => x.key===mk).icon}</div>
            <div class="tierChip ${chipClass(tier)}">${tier || "—"}</div>
          `;
          matrix.appendChild(badge);
        }
        tiersCell.appendChild(matrix);
        table.appendChild(row);
      });

      // if nothing matches
      if (rows.length === 0){
        const empty = document.createElement("div");
        empty.className = "empty";
        empty.textContent = "No players match your search.";
        table.appendChild(empty);
      }
      return table;
    }

    function renderMode(dataset, modeKey){
      const grid = document.createElement("div");
      grid.className = "grid5";

      const q = state.q.toLowerCase();

      for (let tierN=1; tierN<=5; tierN++){
        const col = document.createElement("div");
        col.className = "tierCol";

        // header tint
        const head = document.createElement("div");
        head.className = "tierHead " + (tierN===1?"tierTint1":tierN===2?"tierTint2":tierN===3?"tierTint3":"");
        head.innerHTML = `
          <div class="left">
            <span class="cup">${svgCupSmall()}</span>
            <span>Tier ${tierN}</span>
          </div>
          <label class="sortToggle">
            <input type="checkbox" ${state.sortAZ[tierN] ? "checked":""}/>
            <span>A–Z</span>
          </label>
        `;
        head.querySelector("input").addEventListener("change", (e) => {
          state.sortAZ[tierN] = e.target.checked;
          render();
        });
        col.appendChild(head);

        const list = document.createElement("div");
        list.className = "pList";

        // gather players in this tier group for this mode
        const names = playersInTierGroupForMode(dataset, modeKey, tierN);

        // search filter
        const filtered = names.filter(n => !q || n.toLowerCase().includes(q));

        // sort (visual only)
        const finalList = state.sortAZ[tierN] ? [...filtered].sort((a,b)=>a.localeCompare(b)) : filtered;

        if (finalList.length === 0){
          const empty = document.createElement("div");
          empty.className = "empty";
          empty.textContent = q ? "No matches." : "No players yet.";
          list.appendChild(empty);
        } else {
          for (const name of finalList){
            const tier = dataset.bestTierByMode[modeKey]?.[name] || null;
            const info = tierInfo(tier);

            const card = document.createElement("div");
            card.className = "pCard";
            card.dataset.visible = "1";
            card.dataset.region = (dataset.meta[name]?.region || PLAYER_META[name]?.region || "NA").toUpperCase();
            card.addEventListener("click", () => openModal(name, dataset));

            card.innerHTML = `
              <div class="pAva"><img alt="" src="${AVATAR_URL(name, 56)}" onerror="this.onerror=null;this.src='${fallbackAvatar()}';"></div>
              <div class="pName">${highlight(name, q)}</div>
              <div class="pRight">
                <div class="arrowBtn ${info.retired ? "onRET" : info.isHT ? "onHT":""}">^</div>
                <div class="arrowBtn ${info.retired ? "onRET" : (!info.isHT && tier) ? "onLT":""}">v</div>
              </div>
            `;
            list.appendChild(card);
          }
        }

        col.appendChild(list);
        grid.appendChild(col);
      }

      return grid;
    }

    /******************************************************************
     * MODAL
     ******************************************************************/
    function openModal(playerName, dataset){
      state.openPlayer = playerName;

      const region = (dataset.meta[playerName]?.region || PLAYER_META[playerName]?.region || "NA").toUpperCase();
      const title = combatTitle(dataset.points[playerName] || 0);
      const pts = dataset.points[playerName] || 0;

      modalOverlay.classList.add("show");
      modalOverlay.setAttribute("aria-hidden","false");

      modalName.textContent = playerName;
      modalNameBig.textContent = playerName;
      modalMiniLine.textContent = `${region} • ${title}`;
      modalSubtitle.textContent = `${title} (${pts} points)`;

      modalHeadImg.src = AVATAR_URL(playerName, 96);
      modalHeadImg.onerror = () => { modalHeadImg.onerror=null; modalHeadImg.src = fallbackAvatar(); };

      modalBodyImg.src = BODY_URL(playerName, 320);
      modalBodyImg.onerror = () => { modalBodyImg.onerror=null; modalBodyImg.src = fallbackBody(); };

      // placements chips
      modalPlacements.innerHTML = "";
      for (const mk of MODE_KEYS_NO_OVERALL){
        const tier = dataset.bestTierByMode[mk]?.[playerName] || null;
        const label = MODE_DEFS.find(x=>x.key===mk).label.toUpperCase();
        const chip = document.createElement("div");
        chip.className = "placeChip";
        chip.innerHTML = `<small>${label}</small><span>${tier || "—"}</span>`;
        modalPlacements.appendChild(chip);
      }

      // tier matrix (fixed column grid, never wraps)
      modalMatrix.innerHTML = "";
      for (const mk of MODE_KEYS_NO_OVERALL){
        const tier = dataset.bestTierByMode[mk]?.[playerName] || null;
        const cell = document.createElement("div");
        cell.className = "modeBadge";
        cell.style.width = "64px";
        cell.innerHTML = `
          <div class="modeCircle">${MODE_DEFS.find(x=>x.key===mk).icon}</div>
          <div class="tierChip ${chipClass(tier)}">${tier || "—"}</div>
        `;
        modalMatrix.appendChild(cell);
      }
    }

    function closeModal(){
      modalOverlay.classList.remove("show");
      modalOverlay.setAttribute("aria-hidden","true");
      state.openPlayer = null;
    }

    /******************************************************************
     * DATASET BUILD (placements -> per player tiers -> points -> overall)
     ******************************************************************/
    function buildDataset(){
      const placements = normalizePlacements(PLACEMENTS);

      // collect players
      const playerSet = new Set();
      for (const mk of MODE_KEYS_NO_OVERALL){
        for (const tk of TIER_KEYS){
          for (const name of placements[mk][tk]){
            if (typeof name === "string" && name.trim()) playerSet.add(name.trim());
          }
        }
      }
      const players = [...playerSet];

      // best tier per player per mode
      const bestTierByMode = {};
      for (const mk of MODE_KEYS_NO_OVERALL){
        bestTierByMode[mk] = {};
        for (const name of players){
          bestTierByMode[mk][name] = bestTierForPlayer(placements[mk], name);
        }
      }

      // points
      const points = {};
      for (const name of players){
        let sum = 0;
        for (const mk of MODE_KEYS_NO_OVERALL){
          const t = bestTierByMode[mk][name];
          if (t && TIER_POINTS[t] != null) sum += TIER_POINTS[t];
        }
        points[name] = sum;
      }

      // overall sort
      const overallSorted = players
        .map(name => ({ name, points: points[name] }))
        .sort((a,b) => (b.points - a.points) || a.name.localeCompare(b.name));

      return {
        placements,
        players,
        bestTierByMode,
        points,
        overallSorted,
        meta: PLAYER_META
      };
    }

    function bestTierForPlayer(modeMap, playerName){
      // If player appears in multiple tiers in the same mode, take the highest point tier.
      let best = null;
      let bestPts = -1;
      for (const tk of TIER_KEYS){
        const arr = modeMap[tk];
        if (!Array.isArray(arr)) continue;
        if (arr.some(n => (n||"").trim() === playerName.trim())){
          const pts = TIER_POINTS[tk] ?? -1;
          if (pts > bestPts){
            bestPts = pts;
            best = tk;
          }
        }
      }
      return best;
    }

    function playersInTierGroupForMode(dataset, modeKey, tierN){
      // Uses bestTierByMode, so each player appears once per mode.
      const out = [];
      for (const name of dataset.players){
        const tier = dataset.bestTierByMode[modeKey]?.[name] || null;
        if (tier && TIER_GROUP[tier] === tierN) out.push(name);
      }
      // keep "manual-ish" stable order by points then name (unless A-Z toggle is on)
      out.sort((a,b) => {
        const pa = dataset.points[a]||0, pb = dataset.points[b]||0;
        return (pb - pa) || a.localeCompare(b);
      });
      return out;
    }

    function normalizePlacements(p){
      // ensure every mode and tier exists
      const out = {};
      for (const mk of MODE_KEYS_NO_OVERALL){
        out[mk] = {};
        for (const tk of TIER_KEYS){
          out[mk][tk] = Array.isArray(p?.[mk]?.[tk]) ? p[mk][tk].map(x=>String(x)) : [];
        }
      }
      return out;
    }

    function makeBlankPlacements(){
      const obj = {};
      for (const mk of MODE_KEYS_NO_OVERALL){
        obj[mk] = {};
        for (const tk of TIER_KEYS) obj[mk][tk] = [];
      }
      return obj;
    }

    function autoFillPlaceholders(){
      // creates a consistent set of placeholder names and distributes them
      const names = [];
      const alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      for (let i=0;i<28;i++){
        if (i < 26) names.push(`Player ${alpha[i]}`);
        else names.push(`Player ${alpha[i-26]}${i-25}`); // A1, B2
      }

      // assign regions repeating
      const regions = ["NA","AS","EU"];
      names.forEach((n,i) => {
        PLAYER_META[n] = { region: regions[i%regions.length] };
      });

      // put the first bunch into top tiers across modes, then cascade
      for (const mk of MODE_KEYS_NO_OVERALL){
        PLACEMENTS[mk].HT1 = names.slice(0,6);
        PLACEMENTS[mk].HT2 = names.slice(6,12);
        PLACEMENTS[mk].HT3 = names.slice(12,18);
        PLACEMENTS[mk].LT4 = names.slice(18,24);
        PLACEMENTS[mk].HT5 = names.slice(24,28);
      }
    }

    /******************************************************************
     * TITLES + TIER VISUALS
     ******************************************************************/
    function combatTitle(points){
      if (points >= 420) return "Combat Grandmaster";
      if (points >= 300) return "Combat Master";
      if (points >= 200) return "Combat Ace";
      if (points >= 120) return "Combat Diamond";
      if (points >= 60)  return "Combat Gold";
      return "Combat Rookie";
    }

    function tierInfo(tierKey){
      if (!tierKey) return { isHT:false, retired:false, base:"" };
      const retired = tierKey.startsWith("R");
      const base = retired ? tierKey.slice(1) : tierKey;
      const isHT = base.startsWith("HT");
      return { isHT, retired, base };
    }

    function chipClass(tierKey){
      if (!tierKey) return "";
      const info = tierInfo(tierKey);
      if (info.retired) return "ret";
      return info.isHT ? "ht" : "lt";
    }

    function highlight(text, q){
      if (!q) return escapeHTML(text);
      const i = text.toLowerCase().indexOf(q);
      if (i < 0) return escapeHTML(text);
      const a = escapeHTML(text.slice(0,i));
      const b = escapeHTML(text.slice(i,i+q.length));
      const c = escapeHTML(text.slice(i+q.length));
      return `${a}<span class="hl">${b}</span>${c}`;
    }

    function escapeHTML(s){
      return String(s).replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    /******************************************************************
     * EXPORT / IMPORT
     ******************************************************************/
    function exportJSON(){
      const payload = {
        placements: normalizePlacements(PLACEMENTS),
        playerMeta: PLAYER_META
      };
      const blob = new Blob([JSON.stringify(payload, null, 2)], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "rankings.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(a.href);
    }

    function importJSON(obj){
      // validate
      if (!obj || typeof obj !== "object") return alert("Invalid structure.");
      const placements = obj.placements;
      if (!placements || typeof placements !== "object") return alert("Missing placements.");

      // ensure required modes and tiers exist, arrays of strings
      for (const mk of MODE_KEYS_NO_OVERALL){
        if (!placements[mk] || typeof placements[mk] !== "object") return alert(`Missing mode: ${mk}`);
        for (const tk of TIER_KEYS){
          if (!Array.isArray(placements[mk][tk])) return alert(`Mode ${mk} tier ${tk} must be an array.`);
          if (!placements[mk][tk].every(x => typeof x === "string")) return alert(`Mode ${mk} tier ${tk} must contain strings.`);
        }
      }

      // apply
      PLACEMENTS = placements;

      // optional meta
      if (obj.playerMeta && typeof obj.playerMeta === "object"){
        // merge into PLAYER_META
        for (const [k,v] of Object.entries(obj.playerMeta)){
          if (!v || typeof v !== "object") continue;
          if (v.region) PLAYER_META[k] = { ...(PLAYER_META[k]||{}), region: String(v.region).toUpperCase() };
        }
      }

      render();
      alert("Imported!");
    }

    /******************************************************************
     * FALLBACKS (tiny inline placeholders)
     ******************************************************************/
    function fallbackAvatar(){
      // simple data-url
      const c = document.createElement("canvas");
      c.width = 64; c.height = 64;
      const g = c.getContext("2d");
      g.fillStyle = "#111827"; g.fillRect(0,0,64,64);
      g.fillStyle = "rgba(255,255,255,.18)"; g.fillRect(10,10,44,44);
      g.fillStyle = "rgba(255,255,255,.35)"; g.fillRect(18,22,10,10);
      g.fillRect(36,22,10,10);
      g.fillStyle = "rgba(255,255,255,.25)"; g.fillRect(22,40,20,6);
      return c.toDataURL("image/png");
    }

    function fallbackBody(){
      const c = document.createElement("canvas");
      c.width = 320; c.height = 420;
      const g = c.getContext("2d");
      g.fillStyle = "#0b1220"; g.fillRect(0,0,c.width,c.height);
      g.fillStyle = "rgba(255,255,255,.08)"; g.fillRect(60,40,200,340);
      g.fillStyle = "rgba(255,255,255,.14)"; g.fillRect(110,80,100,100);
      g.fillStyle = "rgba(255,255,255,.10)"; g.fillRect(110,200,100,140);
      return c.toDataURL("image/png");
    }

    /******************************************************************
     * ICONS (inline SVG)
     ******************************************************************/
    function svgTrophy(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M8 4h8v3a4 4 0 0 1-8 0V4z" stroke="rgba(255,211,106,.9)" stroke-width="1.6"/>
        <path d="M6 4H4v3a5 5 0 0 0 5 5" stroke="rgba(255,211,106,.75)" stroke-width="1.6"/>
        <path d="M18 4h2v3a5 5 0 0 1-5 5" stroke="rgba(255,211,106,.75)" stroke-width="1.6"/>
        <path d="M12 12v4" stroke="rgba(255,211,106,.75)" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M9 20h6" stroke="rgba(255,211,106,.75)" stroke-width="1.6" stroke-linecap="round"/>
      </svg>`;
    }
    function svgX(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M7 7l10 10M17 7L7 17" stroke="rgba(240,245,255,.88)" stroke-width="1.8" stroke-linecap="round"/>
      </svg>`;
    }
    function svgCube(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l9 5-9 5-9-5 9-5z" stroke="rgba(220,230,255,.88)" stroke-width="1.4"/>
        <path d="M21 7v10l-9 5V12l9-5z" stroke="rgba(220,230,255,.65)" stroke-width="1.4"/>
        <path d="M3 7v10l9 5V12L3 7z" stroke="rgba(220,230,255,.65)" stroke-width="1.4"/>
      </svg>`;
    }
    function svgHeart(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 20s-7-4.6-9-9a5 5 0 0 1 9-3 5 5 0 0 1 9 3c-2 4.4-9 9-9 9z"
          stroke="rgba(255,120,150,.9)" stroke-width="1.5" fill="rgba(255,120,150,.08)"/>
      </svg>`;
    }
    function svgPotion(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M10 2h4" stroke="rgba(255,255,255,.75)" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M10 2v4l-3 5a6 6 0 0 0 5 9h0a6 6 0 0 0 5-9l-3-5V2" stroke="rgba(230,240,255,.85)" stroke-width="1.5"/>
        <path d="M8 14h8" stroke="rgba(64,201,255,.75)" stroke-width="1.5" stroke-linecap="round"/>
      </svg>`;
    }
    function svgSkull(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 3c4.4 0 8 3.1 8 7 0 2.5-1.4 4.7-3.6 6v3H8.6v-3C5.4 14.7 4 12.5 4 10c0-3.9 3.6-7 8-7z"
          stroke="rgba(200,180,255,.85)" stroke-width="1.5" fill="rgba(200,180,255,.06)"/>
        <path d="M9.5 11h0M14.5 11h0" stroke="rgba(200,180,255,.85)" stroke-width="2.2" stroke-linecap="round"/>
      </svg>`;
    }
    function svgOrb(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <circle cx="12" cy="12" r="7.5" stroke="rgba(64,201,255,.85)" stroke-width="1.5" fill="rgba(64,201,255,.06)"/>
        <path d="M7.5 12c2.2 1.6 6.8 1.6 9 0" stroke="rgba(64,201,255,.65)" stroke-width="1.4" stroke-linecap="round"/>
      </svg>`;
    }
    function svgSword(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M14 3l7 7-9 9-4 1 1-4 9-9z" stroke="rgba(150,220,255,.85)" stroke-width="1.5" fill="rgba(150,220,255,.06)"/>
        <path d="M7 21l-4-4" stroke="rgba(150,220,255,.85)" stroke-width="1.5" stroke-linecap="round"/>
      </svg>`;
    }
    function svgAxe(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M6 3l6 6" stroke="rgba(150,220,255,.85)" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M8 5c6-3 9 0 10 1-1 1-4 4-10 10-2 2-4 3-6 3" stroke="rgba(150,220,255,.8)" stroke-width="1.5" fill="rgba(150,220,255,.06)"/>
      </svg>`;
    }
    function svgMace(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M14 3l7 7-3 3-7-7 3-3z" stroke="rgba(180,190,210,.85)" stroke-width="1.5" fill="rgba(180,190,210,.06)"/>
        <path d="M12 9l-9 9" stroke="rgba(180,190,210,.85)" stroke-width="1.5" stroke-linecap="round"/>
      </svg>`;
    }
    function svgCupSmall(){
      return `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M8 4h8v3a4 4 0 0 1-8 0V4z" stroke="rgba(255,255,255,.75)" stroke-width="1.6"/>
        <path d="M6 4H4v3a5 5 0 0 0 5 5" stroke="rgba(255,255,255,.55)" stroke-width="1.6"/>
        <path d="M18 4h2v3a5 5 0 0 1-5 5" stroke="rgba(255,255,255,.55)" stroke-width="1.6"/>
      </svg>`;
    }

    /******************************************************************
     * DONE
     ******************************************************************/
  </script>
</body>
</html>
